SELECT *
FROM allfoodsandnutrients;
/
SELECT ndb_no,
       flavanones,
       flavan_3_ols,
       anthocyanidins,
       flavonoids,
       flavones,
       flavonols
FROM flav_dat_by_class;
/
CREATE TABLE allfoodsandnutrientsplusflavonoids 
AS
(SELECT a.category,
       a.categoryid,
       a.food,
       a.ndb_no,
       a.n203,
       a.n204,
       a.n205,
       a.n207,
       a.n208,
       a.n209,
       a.n210,
       a.n211,
       a.n212,
       a.n213,
       a.n214,
       a.n221,
       a.n255,
       a.n257,
       a.n262,
       a.n263,
       a.n268,
       a.n269,
       a.n287,
       a.n291,
       a.n301,
       a.n303,
       a.n304,
       a.n305,
       a.n306,
       a.n307,
       a.n309,
       a.n312,
       a.n313,
       a.n315,
       a.n317,
       a.n318,
       a.n319,
       a.n320,
       a.n321,
       a.n322,
       a.n323,
       a.n324,
       a.n325,
       a.n326,
       a.n328,
       a.n334,
       a.n337,
       a.n338,
       a.n341,
       a.n342,
       a.n343,
       a.n344,
       a.n345,
       a.n346,
       a.n347,
       a.n401,
       a.n404,
       a.n405,
       a.n406,
       a.n410,
       a.n415,
       a.n417,
       a.n418,
       a.n421,
       a.n428,
       a.n429,
       a.n430,
       a.n431,
       a.n432,
       a.n435,
       a.n454,
       a.n501,
       a.n502,
       a.n503,
       a.n504,
       a.n505,
       a.n506,
       a.n507,
       a.n508,
       a.n509,
       a.n510,
       a.n511,
       a.n512,
       a.n513,
       a.n514,
       a.n515,
       a.n516,
       a.n517,
       a.n518,
       a.n521,
       a.n573,
       a.n578,
       a.n601,
       a.n605,
       a.n606,
       a.n607,
       a.n608,
       a.n609,
       a.n610,
       a.n611,
       a.n612,
       a.n613,
       a.n614,
       a.n615,
       a.n617,
       a.n618,
       a.n619,
       a.n620,
       a.n621,
       a.n624,
       a.n625,
       a.n626,
       a.n627,
       a.n628,
       a.n629,
       a.n630,
       a.n631,
       a.n636,
       a.n638,
       a.n639,
       a.n641,
       a.n645,
       a.n646,
       a.n652,
       a.n653,
       a.n654,
       a.n662,
       a.n663,
       a.n664,
       a.n665,
       a.n666,
       a.n669,
       a.n670,
       a.n671,
       a.n672,
       a.n673,
       a.n674,
       a.n675,
       a.n676,
       a.n685,
       a.n687,
       a.n689,
       a.n693,
       a.n695,
       a.n696,
       a.n697,
       a.n851,
       a.n852,
       a.n853,
       a.n855,
       a.n856,
       a.n857,
       a.n858,
       a.n859,
       b.flavanones,
       b.isoflavones,
       b.flavan_3_ols,
       b.anthocyanidins,
       b.flavonoids,
       b.flavones,
       b.flavonols
FROM allfoodsandnutrients a
  LEFT JOIN flav_dat_by_class b ON a.ndb_no = b.ndb_no) WITH data;
/
SELECT a.category,
       a.categoryid,
       a.food,
       a.ndb_no,
       a.n203,
       a.n204,
       a.n205,
       a.n207,
       a.n208,
       a.n209,
       a.n210,
       a.n211,
       a.n212,
       a.n213,
       a.n214,
       a.n221,
       a.n255,
       a.n257,
       a.n262,
       a.n263,
       a.n268,
       a.n269,
       a.n287,
       a.n291,
       a.n301,
       a.n303,
       a.n304,
       a.n305,
       a.n306,
       a.n307,
       a.n309,
       a.n312,
       a.n313,
       a.n315,
       a.n317,
       a.n318,
       a.n319,
       a.n320,
       a.n321,
       a.n322,
       a.n323,
       a.n324,
       a.n325,
       a.n326,
       a.n328,
       a.n334,
       a.n337,
       a.n338,
       a.n341,
       a.n342,
       a.n343,
       a.n344,
       a.n345,
       a.n346,
       a.n347,
       a.n401,
       a.n404,
       a.n405,
       a.n406,
       a.n410,
       a.n415,
       a.n417,
       a.n418,
       a.n421,
       a.n428,
       a.n429,
       a.n430,
       a.n431,
       a.n432,
       a.n435,
       a.n454,
       a.n501,
       a.n502,
       a.n503,
       a.n504,
       a.n505,
       a.n506,
       a.n507,
       a.n508,
       a.n509,
       a.n510,
       a.n511,
       a.n512,
       a.n513,
       a.n514,
       a.n515,
       a.n516,
       a.n517,
       a.n518,
       a.n521,
       a.n573,
       a.n578,
       a.n601,
       a.n605,
       a.n606,
       a.n607,
       a.n608,
       a.n609,
       a.n610,
       a.n611,
       a.n612,
       a.n613,
       a.n614,
       a.n615,
       a.n617,
       a.n618,
       a.n619,
       a.n620,
       a.n621,
       a.n624,
       a.n625,
       a.n626,
       a.n627,
       a.n628,
       a.n629,
       a.n630,
       a.n631,
       a.n636,
       a.n638,
       a.n639,
       a.n641,
       a.n645,
       a.n646,
       a.n652,
       a.n653,
       a.n654,
       a.n662,
       a.n663,
       a.n664,
       a.n665,
       a.n666,
       a.n669,
       a.n670,
       a.n671,
       a.n672,
       a.n673,
       a.n674,
       a.n675,
       a.n676,
       a.n685,
       a.n687,
       a.n689,
       a.n693,
       a.n695,
       a.n696,
       a.n697,
       a.n851,
       a.n852,
       a.n853,
       a.n855,
       a.n856,
       a.n857,
       a.n858,
       a.n859,
       a.flavanones,
       a.isoflavones,
       a.flavan_3_ols,
       a.anthocyanidins,
       a.flavonoids,
       a.flavones,
       a.flavonols
FROM allfoodsandnutrientsplusflavonoids a
where a.isoflavones is not null
order by a.isoflavones desc;
/
